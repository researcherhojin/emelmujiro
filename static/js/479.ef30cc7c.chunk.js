"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[479],{5479:(e,t,s)=>{s.r(t),s.d(t,{default:()=>W});var a=s(9643),r=s(9968),l=s(3786),n=s(7798),c=s(273),i=s(2443),d=s(8062),o=s(9302),x=s(9368),m=s(4302),h=s(1309),g=s(2291),u=s(3222),b=s(6026),y=s(9690),p=s(9006),j=s(3656),f=s(4986),v=s(1875),N=s(8575),w=s(3767),k=s(3784),A=s(4499),C=s(9580),R=s(3525),S=s(6207),E=s(6507);const M=()=>{const{t:e}=(0,S.Bd)(),{messages:t,markAsRead:s,sendMessage:n}=(0,h.v)(),c=(0,a.useRef)(null),i=(0,a.useRef)(null),[d,o]=(0,a.useState)(!0);(0,a.useEffect)(()=>{d&&m()},[t,d]),(0,a.useEffect)(()=>{const e=()=>{if(!i.current)return;const{scrollTop:e,scrollHeight:t,clientHeight:s}=i.current;o(t-e-s<100)},t=i.current;if(t)return t.addEventListener("scroll",e),()=>t.removeEventListener("scroll",e)},[]);const m=()=>{var e;null===(e=c.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},g=e=>{const t=new Date,s=new Date(e);return t.toDateString()===s.toDateString()?(0,R.GP)(s,"HH:mm"):(0,R.GP)(s,"MM/dd HH:mm")},u=e=>{switch(e){case"sending":return(0,E.jsx)(x.A,{className:"w-3 h-3 text-gray-400"});case"sent":return(0,E.jsx)(f.A,{className:"w-3 h-3 text-gray-400"});case"delivered":return(0,E.jsx)(v.A,{className:"w-3 h-3 text-gray-400"});case"read":return(0,E.jsx)(v.A,{className:"w-3 h-3 text-blue-500"});case"failed":return(0,E.jsx)(N.A,{className:"w-3 h-3 text-red-500"});default:return null}},b=(e,t)=>{if(e instanceof File){const s=URL.createObjectURL(e),a=document.createElement("a");a.href=s,a.download=t,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(s)}else if(null!==e&&void 0!==e&&e.url){const s=document.createElement("a");s.href=e.url,s.download=t,s.target="_blank",document.body.appendChild(s),s.click(),document.body.removeChild(s)}},y=t=>{var s;switch(t.type){case"text":return(0,E.jsx)("div",{className:"whitespace-pre-wrap break-words",children:t.content});case"image":return(0,E.jsxs)("div",{className:"space-y-2",children:[(0,E.jsxs)("button",{className:"cursor-pointer relative group rounded-lg overflow-hidden max-w-xs focus:outline-none focus:ring-2 focus:ring-blue-500",onClick:()=>((e,t)=>{if(e instanceof File){const s=URL.createObjectURL(e),a=new Image;a.src=s,a.onload=()=>{const e=window.open();e&&e.document.write("\n            <html>\n              <head><title>".concat(t,'</title></head>\n              <body style="margin:0;background:#000;display:flex;align-items:center;justify-content:center;">\n                <img src="').concat(s,'" style="max-width:100%;max-height:100%;object-fit:contain;" />\n              </body>\n            </html>\n          '))}}else null!==e&&void 0!==e&&e.url&&window.open(e.url,"_blank")})(t.file,t.content),type:"button","aria-label":"Preview image: ".concat(t.content),children:[t.file instanceof File?(0,E.jsx)("img",{src:URL.createObjectURL(t.file),alt:t.content,className:"w-full h-auto max-h-48 object-cover group-hover:opacity-90 transition-opacity"}):(0,E.jsx)("div",{className:"w-full h-32 bg-gray-200 dark:bg-gray-700 flex items-center justify-center rounded-lg",children:(0,E.jsx)(w.A,{className:"w-6 h-6 text-gray-400"})}),(0,E.jsx)("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-20 transition-all flex items-center justify-center",children:(0,E.jsx)(w.A,{className:"w-6 h-6 text-white opacity-0 group-hover:opacity-100 transition-opacity"})})]}),(0,E.jsxs)("button",{onClick:()=>b(t.file,t.content),className:"flex items-center space-x-2 text-sm text-blue-600 dark:text-blue-400 hover:underline",children:[(0,E.jsx)(j.A,{className:"w-4 h-4"}),(0,E.jsx)("span",{children:t.content})]})]});case"file":return(0,E.jsx)("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-lg p-3 max-w-xs",children:(0,E.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,E.jsx)("div",{className:"w-10 h-10 bg-gray-200 dark:bg-gray-700 rounded-lg flex items-center justify-center",children:(0,E.jsx)(j.A,{className:"w-5 h-5 text-gray-500"})}),(0,E.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,E.jsx)("div",{className:"text-sm font-medium truncate",children:t.content}),(null===(s=t.file)||void 0===s?void 0:s.size)&&(0,E.jsxs)("div",{className:"text-xs text-gray-500",children:[(t.file.size/1024).toFixed(1)," KB"]})]}),(0,E.jsx)("button",{onClick:()=>b(t.file,t.content),className:"p-1 hover:bg-gray-200 dark:hover:bg-gray-600 rounded",title:e("chat.downloadFile","\ud30c\uc77c \ub2e4\uc6b4\ub85c\ub4dc"),children:(0,E.jsx)(j.A,{className:"w-4 h-4 text-gray-600 dark:text-gray-400"})})]})});case"system":return(0,E.jsx)("div",{className:"text-center text-gray-600 dark:text-gray-400 italic",children:t.content});default:return(0,E.jsx)("div",{children:t.content})}},p=(a,r)=>{const c="user"===a.sender,i="system"===a.sender,d=!c&&!i;return i?(0,E.jsx)(l.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"flex justify-center my-4",children:(0,E.jsxs)("div",{className:"bg-gray-100 dark:bg-gray-800 px-4 py-2 rounded-full text-sm text-gray-600 dark:text-gray-400 flex items-center space-x-2",children:[(0,E.jsx)(k.A,{className:"w-4 h-4"}),(0,E.jsx)("span",{children:a.content})]})},a.id):(0,E.jsx)(l.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"flex ".concat(c?"justify-end":"justify-start"," mb-4"),onViewportEnter:()=>{c||"read"===a.status||s(a.id)},children:(0,E.jsxs)("div",{className:"flex max-w-[70%] ".concat(c?"flex-row-reverse":"flex-row"),children:[d&&(0,E.jsx)("div",{className:"w-8 h-8 rounded-full bg-blue-500 flex items-center justify-center text-white text-sm font-semibold mr-3",children:a.agentName?a.agentName[0]:(0,E.jsx)(A.A,{className:"w-4 h-4"})}),(0,E.jsxs)("div",{className:"flex flex-col",children:[d&&a.agentName&&(0,E.jsx)("div",{className:"text-xs text-gray-500 mb-1 px-2",children:a.agentName}),(0,E.jsxs)("div",{className:"\n                px-4 py-2 rounded-2xl relative\n                ".concat(c?"bg-blue-500 text-white rounded-br-md":"bg-white dark:bg-gray-700 text-gray-900 dark:text-white border border-gray-200 dark:border-gray-600 rounded-bl-md","\n                ").concat("failed"===a.status?"border-red-300 bg-red-50 dark:bg-red-900/20":"","\n              "),children:[y(a),"failed"===a.status&&(0,E.jsx)("div",{className:"mt-2 flex items-center space-x-2",children:(0,E.jsxs)("button",{onClick:()=>(async e=>{const s=t.find(t=>t.id===e);if(s)try{await n({type:s.type,content:s.content,sender:s.sender,file:s.file})}catch(a){console.error("Failed to retry message:",a)}})(a.id),className:"flex items-center space-x-1 text-xs text-red-600 hover:text-red-700",children:[(0,E.jsx)(C.A,{className:"w-3 h-3"}),(0,E.jsx)("span",{children:e("chat.retry","\ub2e4\uc2dc \uc2dc\ub3c4")})]})})]}),(0,E.jsxs)("div",{className:"flex items-center mt-1 text-xs text-gray-500 ".concat(c?"justify-end":"justify-start"),children:[(0,E.jsx)("span",{className:"mr-1",children:g(a.timestamp)}),c&&u(a.status)]})]})]})},a.id)};return 0===t.length?(0,E.jsx)("div",{className:"flex-1 flex items-center justify-center p-8",children:(0,E.jsxs)("div",{className:"text-center text-gray-500 dark:text-gray-400",children:[(0,E.jsx)(A.A,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),(0,E.jsx)("p",{className:"text-lg font-medium mb-2",children:e("chat.emptyState.title","\ub300\ud654\ub97c \uc2dc\uc791\ud574\ubcf4\uc138\uc694")}),(0,E.jsx)("p",{className:"text-sm",children:e("chat.emptyState.subtitle","\uad81\uae08\ud55c \uac83\uc774 \uc788\uc73c\uc2dc\uba74 \uc5b8\uc81c\ub4e0 \ubb3c\uc5b4\ubcf4\uc138\uc694!")})]})}):(0,E.jsxs)("div",{ref:i,className:"flex-1 overflow-y-auto px-4 py-2 scroll-smooth",style:{scrollBehavior:"smooth"},children:[(0,E.jsx)(r.N,{children:t.map((e,t)=>p(e))}),(0,E.jsx)("div",{ref:c}),(0,E.jsx)(r.N,{children:!d&&(0,E.jsx)(l.P.button,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},onClick:m,className:"fixed bottom-20 right-8 w-10 h-10 bg-blue-500 hover:bg-blue-600 text-white rounded-full shadow-lg flex items-center justify-center transition-colors",title:e("chat.scrollToBottom","\ucd5c\uc2e0 \uba54\uc2dc\uc9c0\ub85c \uc774\ub3d9"),children:(0,E.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 14l-7 7m0 0l-7-7m7 7V3"})})})})]})};var L=s(1877),P=s(8429),O=s(6835),F=s(8494);const U=e=>{let{onSelect:t}=e;const{t:s}=(0,S.Bd)(),{settings:a}=(0,h.v)(),r=[{id:"service",text:s("chat.quickReplies.service","\uc11c\ube44\uc2a4 \ubb38\uc758"),icon:L.A,color:"bg-blue-50 dark:bg-blue-900/20 text-blue-600 dark:text-blue-400 border-blue-200 dark:border-blue-800"},{id:"technical",text:s("chat.quickReplies.technical","\uae30\uc220 \uc9c0\uc6d0"),icon:P.A,color:"bg-green-50 dark:bg-green-900/20 text-green-600 dark:text-green-400 border-green-200 dark:border-green-800"},{id:"pricing",text:s("chat.quickReplies.pricing","\uc694\uae08 \ubb38\uc758"),icon:O.A,color:"bg-amber-50 dark:bg-amber-900/20 text-amber-600 dark:text-amber-400 border-amber-200 dark:border-amber-800"},{id:"contact",text:s("chat.quickReplies.contact","\uc5f0\ub77d\ucc98 \ubb38\uc758"),icon:F.A,color:"bg-purple-50 dark:bg-purple-900/20 text-purple-600 dark:text-purple-400 border-purple-200 dark:border-purple-800"}],n=e=>{t(e)};return(0,E.jsxs)("div",{className:"p-4 bg-gray-50 dark:bg-gray-900",children:[(0,E.jsx)("div",{className:"mb-3",children:(0,E.jsx)("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:s("chat.quickReplies.title","\ube60\ub978 \ub2f5\ubcc0\uc744 \uc120\ud0dd\ud558\uc138\uc694")})}),(0,E.jsx)("div",{className:"grid grid-cols-2 gap-2",children:r.map((e,t)=>{const s=e.icon;return(0,E.jsx)(l.P.button,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*t},onClick:()=>n(e.text),className:"\n                p-3 rounded-lg border text-left transition-all duration-200\n                hover:shadow-sm hover:scale-105 active:scale-95\n                focus:outline-none focus:ring-2 focus:ring-blue-500/30\n                ".concat(e.color,"\n              "),children:(0,E.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,E.jsx)(s,{className:"w-4 h-4 flex-shrink-0"}),(0,E.jsx)("span",{className:"text-sm font-medium",children:e.text})]})},e.id)})}),a.quickReplies.length>4&&(0,E.jsx)("div",{className:"mt-3 space-y-1",children:a.quickReplies.slice(4).map((e,t)=>(0,E.jsx)(l.P.button,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.1*(t+4)},onClick:()=>n(e),className:" w-full p-2 text-left text-sm  bg-white dark:bg-gray-800  border border-gray-200 dark:border-gray-700  rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700  transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500/30 ",children:e},"custom-".concat(t)))}),(0,E.jsx)("div",{className:"mt-3 text-center",children:(0,E.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:s("chat.quickReplies.or","\ub610\ub294 \uc9c1\uc811 \uba54\uc2dc\uc9c0\ub97c \uc785\ub825\ud558\uc138\uc694")})})]})},H=()=>{const{t:e}=(0,S.Bd)();return(0,E.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,E.jsx)("div",{className:"w-8 h-8 rounded-full bg-blue-500 flex items-center justify-center text-white",children:(0,E.jsx)(A.A,{className:"w-4 h-4"})}),(0,E.jsxs)("div",{className:"bg-gray-200 dark:bg-gray-700 rounded-2xl rounded-bl-md px-4 py-3 flex items-center space-x-1",children:[(0,E.jsx)("div",{className:"flex space-x-1",children:[0,1,2].map(e=>(0,E.jsx)(l.P.div,{className:"w-2 h-2 bg-gray-500 dark:bg-gray-400 rounded-full",animate:{scale:[1,1.3,1],opacity:[.5,1,.5]},transition:{duration:1.4,repeat:1/0,delay:.2*e,ease:"easeInOut"}},e))}),(0,E.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-400 ml-2",children:e("chat.typing","\uc785\ub825 \uc911...")})]})]})};var T=s(1780);const B=e=>{let{onSelect:t,onClose:s}=e;const{t:r}=(0,S.Bd)(),[n,c]=(0,a.useState)(""),[i,o]=(0,a.useState)("smileys"),x={smileys:{name:r("chat.emoji.smileys","\ud45c\uc815"),emojis:["\ud83d\ude00","\ud83d\ude03","\ud83d\ude04","\ud83d\ude01","\ud83d\ude06","\ud83d\ude05","\ud83e\udd23","\ud83d\ude02","\ud83d\ude42","\ud83d\ude43","\ud83d\ude09","\ud83d\ude0a","\ud83d\ude07","\ud83e\udd70","\ud83d\ude0d","\ud83e\udd29","\ud83d\ude18","\ud83d\ude17","\ud83d\ude1a","\ud83d\ude19","\ud83d\ude0b","\ud83d\ude1b","\ud83d\ude1c","\ud83e\udd2a","\ud83d\ude1d","\ud83e\udd11","\ud83e\udd17","\ud83e\udd2d","\ud83e\udd2b","\ud83e\udd14","\ud83d\ude10","\ud83d\ude11","\ud83d\ude36","\ud83d\ude0f","\ud83d\ude12","\ud83d\ude44","\ud83d\ude2c","\ud83e\udd10","\ud83d\ude37","\ud83e\udd12","\ud83e\udd15","\ud83e\udd22","\ud83e\udd2e","\ud83e\udd27","\ud83e\udd75","\ud83e\udd76","\ud83e\udd74","\ud83d\ude35","\ud83e\udd2f","\ud83e\udd20"]},gestures:{name:r("chat.emoji.gestures","\uc81c\uc2a4\ucc98"),emojis:["\ud83d\udc4d","\ud83d\udc4e","\ud83d\udc4c","\ud83e\udd0c","\ud83e\udd0f","\u270c\ufe0f","\ud83e\udd1e","\ud83e\udd1f","\ud83e\udd18","\ud83e\udd19","\ud83d\udc48","\ud83d\udc49","\ud83d\udc46","\ud83d\udd95","\ud83d\udc47","\u261d\ufe0f","\ud83d\udc4b","\ud83e\udd1a","\ud83d\udd90\ufe0f","\u270b","\ud83d\udd96","\ud83d\udc4f","\ud83d\ude4c","\ud83e\udd1d","\ud83d\udc50","\ud83e\udd32","\ud83e\udd1c","\ud83e\udd1b","\u270a","\ud83d\udc4a","\ud83d\ude4f","\u270d\ufe0f","\ud83d\udcaa","\ud83e\uddbe","\ud83e\uddb5","\ud83e\uddbf","\ud83d\udc84","\ud83d\udc8b","\ud83d\udc44","\ud83d\udc45"]},objects:{name:r("chat.emoji.objects","\uc0ac\ubb3c"),emojis:["\ud83d\udcbb","\ud83d\udda5\ufe0f","\ud83d\udda8\ufe0f","\u2328\ufe0f","\ud83d\uddb1\ufe0f","\ud83d\uddb2\ufe0f","\ud83d\udcbd","\ud83d\udcbe","\ud83d\udcbf","\ud83d\udcc0","\ud83d\udcf1","\u260e\ufe0f","\ud83d\udcde","\ud83d\udcdf","\ud83d\udce0","\ud83d\udcfa","\ud83d\udcfb","\ud83c\udfb5","\ud83c\udfb6","\ud83c\udfa4","\ud83c\udfa7","\ud83d\udce2","\ud83d\udce3","\ud83d\udcef","\ud83d\udd14","\ud83d\udd15","\ud83d\udcea","\ud83d\udceb","\ud83d\udcec","\ud83d\udced","\ud83d\udcee","\ud83d\uddf3\ufe0f","\u270f\ufe0f","\u2712\ufe0f","\ud83d\udd8b\ufe0f","\ud83d\udd8a\ufe0f","\ud83d\udd8c\ufe0f","\ud83d\udd0d","\ud83d\udd0e","\ud83d\udca1"]},symbols:{name:r("chat.emoji.symbols","\uae30\ud638"),emojis:["\u2764\ufe0f","\ud83e\udde1","\ud83d\udc9b","\ud83d\udc9a","\ud83d\udc99","\ud83d\udc9c","\ud83d\udda4","\ud83e\udd0d","\ud83e\udd0e","\ud83d\udc94","\u2763\ufe0f","\ud83d\udc95","\ud83d\udc9e","\ud83d\udc93","\ud83d\udc97","\ud83d\udc96","\ud83d\udc98","\ud83d\udc9d","\ud83d\udc9f","\u262e\ufe0f","\u271d\ufe0f","\u262a\ufe0f","\ud83d\udd49\ufe0f","\u2638\ufe0f","\u2721\ufe0f","\ud83d\udd2f","\ud83d\udd4e","\u262f\ufe0f","\u2626\ufe0f","\ud83d\uded0","\u26ce","\u2648","\u2649","\u264a","\u264b","\u264c","\u264d","\u264e","\u264f","\u2650"]}},m=n?Object.values(x).flatMap(e=>e.emojis).filter(e=>e.includes(n)):x[i].emojis;return(0,E.jsxs)(l.P.div,{initial:{opacity:0,y:10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.95},className:"absolute bottom-full left-0 w-80 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-xl z-10 mb-2",children:[(0,E.jsxs)("div",{className:"flex items-center justify-between p-3 border-b border-gray-200 dark:border-gray-700",children:[(0,E.jsx)("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:r("chat.emoji.title","\uc774\ubaa8\uc9c0 \uc120\ud0dd")}),(0,E.jsx)("button",{onClick:s,className:"p-1 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors","aria-label":r("common.close","\ub2eb\uae30"),children:(0,E.jsx)(d.A,{className:"w-4 h-4 text-gray-500"})})]}),(0,E.jsx)("div",{className:"p-3 border-b border-gray-200 dark:border-gray-700",children:(0,E.jsxs)("div",{className:"relative",children:[(0,E.jsx)(T.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),(0,E.jsx)("input",{type:"text",value:n,onChange:e=>c(e.target.value),placeholder:r("chat.emoji.search","\uc774\ubaa8\uc9c0 \uac80\uc0c9..."),className:"w-full pl-10 pr-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400"})]})}),!n&&(0,E.jsx)("div",{className:"flex border-b border-gray-200 dark:border-gray-700",children:Object.entries(x).map(e=>{let[t,s]=e;return(0,E.jsx)("button",{onClick:()=>o(t),className:"flex-1 px-3 py-2 text-xs font-medium transition-colors ".concat(i===t?"bg-blue-50 dark:bg-blue-900/20 text-blue-600 dark:text-blue-400 border-b-2 border-blue-500":"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300"),children:s.name},t)})}),(0,E.jsx)("div",{className:"p-3 max-h-64 overflow-y-auto",children:(0,E.jsx)("div",{className:"grid grid-cols-8 gap-1",children:m.map((e,s)=>(0,E.jsx)(l.P.button,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{delay:.01*s},whileHover:{scale:1.2},whileTap:{scale:.9},onClick:()=>(e=>{t(e)})(e),className:"p-2 text-xl hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500/30",title:e,children:e},"".concat(e,"-").concat(s)))})}),(0,E.jsx)("div",{className:"p-3 border-t border-gray-200 dark:border-gray-700 text-center",children:(0,E.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:r("chat.emoji.tip","\uc774\ubaa8\uc9c0\ub97c \ud074\ub9ad\ud558\uc5ec \ucd94\uac00\ud558\uc138\uc694")})})]})},D=()=>{const{t:e}=(0,S.Bd)(),{showNotification:t}=(0,m.m)(),{messages:s,isTyping:n,isConnected:c,agentAvailable:i,businessHours:d,sendMessage:o,startTyping:f,stopTyping:v}=(0,h.v)(),[N,w]=(0,a.useState)(""),[k,A]=(0,a.useState)(!0),[C,R]=(0,a.useState)(!1),[L,P]=(0,a.useState)(!1),O=(0,a.useRef)(null),F=(0,a.useRef)(null);(0,a.useEffect)(()=>{O.current&&O.current.focus()},[]),(0,a.useEffect)(()=>(N.trim()&&!L?(P(!0),f()):!N.trim()&&L&&(P(!1),v()),()=>{L&&v()}),[N,L,f,v]),(0,a.useEffect)(()=>{O.current&&(O.current.style.height="auto",O.current.style.height=Math.min(O.current.scrollHeight,100)+"px")},[N]);const T=async()=>{const s=N.trim();if(s){w(""),A(!1),P(!1),v();try{await o({type:"text",content:s,sender:"user"})}catch(a){t("error",e("chat.error.sendFailed","\uba54\uc2dc\uc9c0 \uc804\uc1a1\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.")),w(s)}}},D=c&&N.trim().length>0;return(0,E.jsxs)("div",{className:"flex flex-col h-full",children:[!c&&(0,E.jsx)("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border-b border-yellow-200 dark:border-yellow-800 px-4 py-2",children:(0,E.jsxs)("div",{className:"flex items-center space-x-2 text-yellow-700 dark:text-yellow-300",children:[(0,E.jsx)(g.A,{className:"w-4 h-4"}),(0,E.jsx)("span",{className:"text-xs",children:e("chat.connectionStatus.reconnecting","\uc5f0\uacb0 \uc911... \uba54\uc2dc\uc9c0\ub294 \uc5f0\uacb0 \ud6c4 \uc804\uc1a1\ub429\ub2c8\ub2e4.")})]})}),c&&!d.isOpen&&(0,E.jsx)("div",{className:"bg-blue-50 dark:bg-blue-900/20 border-b border-blue-200 dark:border-blue-800 px-4 py-2",children:(0,E.jsxs)("div",{className:"flex items-center space-x-2 text-blue-700 dark:text-blue-300",children:[(0,E.jsx)(x.A,{className:"w-4 h-4"}),(0,E.jsxs)("div",{className:"text-xs",children:[(0,E.jsx)("div",{children:e("chat.afterHours.title","\uc6b4\uc601\uc2dc\uac04 \uc678\uc785\ub2c8\ub2e4")}),(0,E.jsx)("div",{className:"text-blue-600 dark:text-blue-400",children:e("chat.afterHours.message","\uc6b4\uc601\uc2dc\uac04: ".concat(d.hours))})]})]})}),(0,E.jsxs)("div",{className:"flex-1 overflow-hidden bg-gray-50 dark:bg-gray-900 relative",children:[(0,E.jsx)(M,{}),(0,E.jsx)(r.N,{children:n&&(0,E.jsx)(l.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"px-4 py-2",children:(0,E.jsx)(H,{})})})]}),(0,E.jsx)(r.N,{children:k&&0===s.length&&(0,E.jsx)(l.P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"border-t border-gray-200 dark:border-gray-700",children:(0,E.jsx)(U,{onSelect:e=>{w(e),O.current&&O.current.focus()}})})}),(0,E.jsxs)("div",{className:"border-t border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 p-4",children:[(0,E.jsxs)("div",{className:"flex items-end space-x-2",children:[(0,E.jsx)("button",{onClick:()=>{F.current&&F.current.click()},disabled:!c,className:"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:e("chat.attachFile","\ud30c\uc77c \ucca8\ubd80"),children:(0,E.jsx)(u.A,{className:"w-5 h-5 text-gray-500"})}),(0,E.jsxs)("div",{className:"flex-1 relative",children:[(0,E.jsx)("textarea",{ref:O,value:N,onChange:e=>w(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),T())},placeholder:c?e("chat.placeholder.connected","\uba54\uc2dc\uc9c0\ub97c \uc785\ub825\ud558\uc138\uc694..."):e("chat.placeholder.disconnected","\uc5f0\uacb0 \uc911..."),disabled:!c,className:" w-full px-3 py-2 pr-12  border border-gray-300 dark:border-gray-600  rounded-lg resize-none  focus:ring-2 focus:ring-blue-500 focus:border-transparent  bg-white dark:bg-gray-700  text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 disabled:bg-gray-100 dark:disabled:bg-gray-800  disabled:cursor-not-allowed transition-colors ",rows:1,maxLength:1e3}),N.length>800&&(0,E.jsxs)("div",{className:"absolute -top-6 right-0 text-xs text-gray-500",children:[N.length,"/1000"]}),(0,E.jsx)("button",{onClick:()=>R(!C),className:"absolute right-2 top-1/2 transform -translate-y-1/2 p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors",title:e("chat.addEmoji","\uc774\ubaa8\uc9c0 \ucd94\uac00"),children:(0,E.jsx)(b.A,{className:"w-4 h-4 text-gray-500"})})]}),(0,E.jsx)("button",{onClick:T,disabled:!D,className:" p-2 rounded-full  bg-blue-500 hover:bg-blue-600  disabled:bg-gray-300 dark:disabled:bg-gray-600 disabled:cursor-not-allowed  transition-colors ",title:e("chat.send","\uc804\uc1a1"),children:(0,E.jsx)(y.A,{className:"w-5 h-5 text-white"})})]}),(0,E.jsxs)("div",{className:"flex items-center justify-between mt-2 text-xs text-gray-500",children:[(0,E.jsx)("div",{className:"flex items-center space-x-4",children:(0,E.jsx)("span",{children:c?(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)(p.A,{className:"w-3 h-3 inline mr-1 text-green-500"}),e("chat.status.connected","\uc5f0\uacb0\ub428")]}):(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)(g.A,{className:"w-3 h-3 inline mr-1 text-yellow-500"}),e("chat.status.connecting","\uc5f0\uacb0 \uc911...")]})})}),(0,E.jsxs)("button",{onClick:async()=>{try{const a={timestamp:(new Date).toISOString(),messages:s,participantInfo:{user:"Customer",agent:i?"Support Agent":"Chatbot"}},r=new Blob([JSON.stringify(a,null,2)],{type:"application/json"}),l=URL.createObjectURL(r),n=document.createElement("a");n.href=l,n.download="chat-transcript-".concat((new Date).toISOString().split("T")[0],".json"),document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(l),t("success",e("chat.exportSuccess","\ucc44\ud305 \uae30\ub85d\uc744 \ub2e4\uc6b4\ub85c\ub4dc\ud588\uc2b5\ub2c8\ub2e4."))}catch(a){t("error",e("chat.error.exportFailed","\ucc44\ud305 \uae30\ub85d \ub0b4\ubcf4\ub0b4\uae30\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4."))}},disabled:0===s.length,className:"flex items-center space-x-1 hover:text-gray-700 dark:hover:text-gray-300 disabled:opacity-50 disabled:cursor-not-allowed",title:e("chat.exportTranscript","\ub300\ud654 \ub0b4\uc6a9 \ub0b4\ubcf4\ub0b4\uae30"),children:[(0,E.jsx)(j.A,{className:"w-3 h-3"}),(0,E.jsx)("span",{children:e("chat.export","\ub0b4\ubcf4\ub0b4\uae30")})]})]})]}),(0,E.jsx)(r.N,{children:C&&(0,E.jsx)(B,{onSelect:e=>{w(t=>t+e),R(!1),O.current&&O.current.focus()},onClose:()=>R(!1)})}),(0,E.jsx)("input",{ref:F,type:"file",accept:"image/*,application/pdf,.doc,.docx,.txt",onChange:async s=>{const a=s.target.files;if(!a||0===a.length)return;const r=a[0];if(r.size>10485760)t("error",e("chat.error.fileTooLarge","\ud30c\uc77c \ud06c\uae30\uac00 \ub108\ubb34 \ud07d\ub2c8\ub2e4. (\ucd5c\ub300 10MB)"));else{try{await o({type:"file",content:r.name,file:r,sender:"user"})}catch(l){t("error",e("chat.error.uploadFailed","\ud30c\uc77c \uc5c5\ub85c\ub4dc\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4."))}F.current&&(F.current.value="")}},className:"hidden"})]})};var I=s(7405),z=s(9441),q=s(2013),K=s(9800),V=s(8876),G=s(6007),J=s(2067);const _=e=>{let{isOpen:t,onClose:s}=e;const{t:r}=(0,S.Bd)(),{showNotification:c}=(0,m.m)(),{settings:i,messages:o,businessHours:g,connectionId:u}=(0,h.v)(),[b,y]=(0,a.useState)("settings"),[p,j]=(0,a.useState)(i),[v,N]=(0,a.useState)(""),[w,k]=(0,a.useState)(null),[A,R]=(0,a.useState)(""),M=[{id:"settings",label:r("chat.admin.settings","\uc124\uc815"),icon:P.A},{id:"canned",label:r("chat.admin.cannedResponses","\uc790\ub3d9 \uc751\ub2f5"),icon:L.A},{id:"stats",label:r("chat.admin.statistics","\ud1b5\uacc4"),icon:z.A},{id:"users",label:r("chat.admin.users","\uc0ac\uc6a9\uc790"),icon:n.A}],O=()=>{v.trim()&&(j(e=>(0,I.A)((0,I.A)({},e),{},{cannedResponses:[...e.cannedResponses,v.trim()]})),N(""))},F=()=>{null!==w&&A.trim()&&(j(e=>(0,I.A)((0,I.A)({},e),{},{cannedResponses:e.cannedResponses.map((e,t)=>t===w?A.trim():e)})),k(null),R(""))},U=(()=>{const e=o.length,t=o.filter(e=>"user"===e.sender).length,s=o.filter(e=>"agent"===e.sender).length,a=o.filter(e=>"system"===e.sender).length,r=(new Date).toDateString();return{totalMessages:e,userMessages:t,agentMessages:s,systemMessages:a,todayMessages:o.filter(e=>e.timestamp.toDateString()===r).length,averageResponseTime:"2.3\ubd84",satisfactionRating:"4.7/5"}})();return t?(0,E.jsx)(l.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:s,children:(0,E.jsxs)(l.P.div,{initial:{scale:.9,y:20},animate:{scale:1,y:0},exit:{scale:.9,y:20},onClick:e=>e.stopPropagation(),className:"bg-white dark:bg-gray-800 rounded-lg shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-hidden",children:[(0,E.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[(0,E.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,E.jsx)(P.A,{className:"w-6 h-6 text-blue-600"}),(0,E.jsx)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:r("chat.admin.title","\ucc44\ud305 \uad00\ub9ac\uc790 \ud328\ub110")})]}),(0,E.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,E.jsx)("div",{className:"text-sm text-gray-500",children:u&&(0,E.jsxs)("span",{className:"flex items-center space-x-1",children:[(0,E.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),(0,E.jsx)("span",{children:r("chat.admin.connected","\uc5f0\uacb0\ub428")})]})}),(0,E.jsx)("button",{onClick:s,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:(0,E.jsx)(d.A,{className:"w-5 h-5"})})]})]}),(0,E.jsx)("div",{className:"flex border-b border-gray-200 dark:border-gray-700",children:M.map(e=>{const t=e.icon;return(0,E.jsxs)("button",{onClick:()=>y(e.id),className:"flex items-center space-x-2 px-6 py-3 font-medium transition-colors ".concat(b===e.id?"text-blue-600 border-b-2 border-blue-600 bg-blue-50 dark:bg-blue-900/20":"text-gray-500 hover:text-gray-700 dark:hover:text-gray-300"),children:[(0,E.jsx)(t,{className:"w-4 h-4"}),(0,E.jsx)("span",{children:e.label})]},e.id)})}),(0,E.jsxs)("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-200px)]",children:["settings"===b&&(0,E.jsxs)("div",{className:"space-y-6",children:[(0,E.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,E.jsxs)("div",{children:[(0,E.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:r("chat.admin.welcomeMessage","\ud658\uc601 \uba54\uc2dc\uc9c0")}),(0,E.jsx)("textarea",{value:p.welcomeMessage,onChange:e=>j(t=>(0,I.A)((0,I.A)({},t),{},{welcomeMessage:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white",rows:3})]}),(0,E.jsxs)("div",{children:[(0,E.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:r("chat.admin.maxMessageLength","\ucd5c\ub300 \uba54\uc2dc\uc9c0 \uae38\uc774")}),(0,E.jsx)("input",{type:"number",value:p.maxMessageLength,onChange:e=>j(t=>(0,I.A)((0,I.A)({},t),{},{maxMessageLength:parseInt(e.target.value)})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white",min:"100",max:"5000"})]})]}),(0,E.jsxs)("div",{className:"space-y-4",children:[(0,E.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:r("chat.admin.features","\uae30\ub2a5 \uc124\uc815")}),(0,E.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,E.jsxs)("label",{className:"flex items-center space-x-3",children:[(0,E.jsx)("input",{type:"checkbox",checked:p.allowFileUpload,onChange:e=>j(t=>(0,I.A)((0,I.A)({},t),{},{allowFileUpload:e.target.checked})),className:"w-4 h-4 text-blue-600 rounded"}),(0,E.jsx)("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:r("chat.admin.allowFileUpload","\ud30c\uc77c \uc5c5\ub85c\ub4dc \ud5c8\uc6a9")})]}),(0,E.jsxs)("label",{className:"flex items-center space-x-3",children:[(0,E.jsx)("input",{type:"checkbox",checked:p.allowEmoji,onChange:e=>j(t=>(0,I.A)((0,I.A)({},t),{},{allowEmoji:e.target.checked})),className:"w-4 h-4 text-blue-600 rounded"}),(0,E.jsx)("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:r("chat.admin.allowEmoji","\uc774\ubaa8\uc9c0 \uc0ac\uc6a9 \ud5c8\uc6a9")})]}),(0,E.jsxs)("label",{className:"flex items-center space-x-3",children:[(0,E.jsx)("input",{type:"checkbox",checked:p.soundEnabled,onChange:e=>j(t=>(0,I.A)((0,I.A)({},t),{},{soundEnabled:e.target.checked})),className:"w-4 h-4 text-blue-600 rounded"}),(0,E.jsx)("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:r("chat.admin.soundEnabled","\uc54c\ub9bc\uc74c \ud65c\uc131\ud654")})]})]})]}),(0,E.jsxs)("button",{onClick:()=>{try{localStorage.setItem("chat-admin-settings",JSON.stringify(p)),c("success",r("chat.admin.settingsSaved","\uc124\uc815\uc774 \uc800\uc7a5\ub418\uc5c8\uc2b5\ub2c8\ub2e4."))}catch(e){c("error",r("chat.admin.settingsSaveFailed","\uc124\uc815 \uc800\uc7a5\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4."))}},className:"flex items-center space-x-2 bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors",children:[(0,E.jsx)(q.A,{className:"w-4 h-4"}),(0,E.jsx)("span",{children:r("chat.admin.saveSettings","\uc124\uc815 \uc800\uc7a5")})]})]}),"canned"===b&&(0,E.jsxs)("div",{className:"space-y-4",children:[(0,E.jsx)("div",{className:"flex items-center justify-between",children:(0,E.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:r("chat.admin.cannedResponses","\uc790\ub3d9 \uc751\ub2f5 \uad00\ub9ac")})}),(0,E.jsxs)("div",{className:"flex space-x-2",children:[(0,E.jsx)("input",{type:"text",value:v,onChange:e=>N(e.target.value),placeholder:r("chat.admin.addCannedResponse","\uc0c8 \uc790\ub3d9 \uc751\ub2f5 \ucd94\uac00..."),className:"flex-1 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white",onKeyPress:e=>"Enter"===e.key&&O()}),(0,E.jsxs)("button",{onClick:O,disabled:!v.trim(),className:"bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white px-4 py-2 rounded-lg transition-colors flex items-center space-x-2",children:[(0,E.jsx)(K.A,{className:"w-4 h-4"}),(0,E.jsx)("span",{children:r("chat.admin.add","\ucd94\uac00")})]})]}),(0,E.jsx)("div",{className:"space-y-2",children:p.cannedResponses.map((e,t)=>(0,E.jsx)("div",{className:"flex items-center space-x-2 p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:w===t?(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)("input",{type:"text",value:A,onChange:e=>R(e.target.value),className:"flex-1 px-2 py-1 border border-gray-300 dark:border-gray-600 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white dark:bg-gray-600 text-gray-900 dark:text-white",onKeyPress:e=>"Enter"===e.key&&F()}),(0,E.jsx)("button",{onClick:F,className:"text-green-600 hover:text-green-700 p-1",children:(0,E.jsx)(f.A,{className:"w-4 h-4"})}),(0,E.jsx)("button",{onClick:()=>{k(null),R("")},className:"text-gray-500 hover:text-gray-700 p-1",children:(0,E.jsx)(d.A,{className:"w-4 h-4"})})]}):(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)("span",{className:"flex-1 text-gray-900 dark:text-white",children:e}),(0,E.jsx)("button",{onClick:()=>(e=>{k(e),R(p.cannedResponses[e])})(t),className:"text-blue-600 hover:text-blue-700 p-1",children:(0,E.jsx)(V.A,{className:"w-4 h-4"})}),(0,E.jsx)("button",{onClick:()=>(e=>{j(t=>(0,I.A)((0,I.A)({},t),{},{cannedResponses:t.cannedResponses.filter((t,s)=>s!==e)}))})(t),className:"text-red-600 hover:text-red-700 p-1",children:(0,E.jsx)(G.A,{className:"w-4 h-4"})})]})},t))})]}),"stats"===b&&(0,E.jsxs)("div",{className:"space-y-6",children:[(0,E.jsxs)("div",{className:"flex items-center justify-between",children:[(0,E.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:r("chat.admin.statistics","\ucc44\ud305 \ud1b5\uacc4")}),(0,E.jsxs)("button",{className:"flex items-center space-x-2 text-blue-600 hover:text-blue-700",children:[(0,E.jsx)(C.A,{className:"w-4 h-4"}),(0,E.jsx)("span",{children:r("chat.admin.refresh","\uc0c8\ub85c\uace0\uce68")})]})]}),(0,E.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,E.jsx)("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg",children:(0,E.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,E.jsx)(L.A,{className:"w-5 h-5 text-blue-600"}),(0,E.jsxs)("div",{children:[(0,E.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:U.totalMessages}),(0,E.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:r("chat.admin.totalMessages","\ucd1d \uba54\uc2dc\uc9c0")})]})]})}),(0,E.jsx)("div",{className:"bg-green-50 dark:bg-green-900/20 p-4 rounded-lg",children:(0,E.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,E.jsx)(J.A,{className:"w-5 h-5 text-green-600"}),(0,E.jsxs)("div",{children:[(0,E.jsx)("div",{className:"text-2xl font-bold text-green-600",children:U.userMessages}),(0,E.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:r("chat.admin.userMessages","\uc0ac\uc6a9\uc790 \uba54\uc2dc\uc9c0")})]})]})}),(0,E.jsx)("div",{className:"bg-purple-50 dark:bg-purple-900/20 p-4 rounded-lg",children:(0,E.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,E.jsx)(x.A,{className:"w-5 h-5 text-purple-600"}),(0,E.jsxs)("div",{children:[(0,E.jsx)("div",{className:"text-2xl font-bold text-purple-600",children:U.averageResponseTime}),(0,E.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:r("chat.admin.avgResponseTime","\ud3c9\uade0 \uc751\ub2f5\uc2dc\uac04")})]})]})}),(0,E.jsx)("div",{className:"bg-amber-50 dark:bg-amber-900/20 p-4 rounded-lg",children:(0,E.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,E.jsx)(z.A,{className:"w-5 h-5 text-amber-600"}),(0,E.jsxs)("div",{children:[(0,E.jsx)("div",{className:"text-2xl font-bold text-amber-600",children:U.satisfactionRating}),(0,E.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:r("chat.admin.satisfaction","\ub9cc\uc871\ub3c4")})]})]})})]}),(0,E.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg",children:[(0,E.jsx)("h4",{className:"font-medium text-gray-900 dark:text-white mb-2",children:r("chat.admin.businessHours","\uc6b4\uc601 \ud604\ud669")}),(0,E.jsxs)("div",{className:"flex items-center space-x-4 text-sm",children:[(0,E.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,E.jsx)("div",{className:"w-3 h-3 rounded-full ".concat(g.isOpen?"bg-green-500":"bg-red-500")}),(0,E.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:g.isOpen?r("chat.admin.currentlyOpen","\ud604\uc7ac \uc6b4\uc601 \uc911"):r("chat.admin.currentlyClosed","\ud604\uc7ac \uc6b4\uc601 \uc885\ub8cc")})]}),(0,E.jsx)("div",{className:"text-gray-600 dark:text-gray-400",children:g.hours})]})]})]}),"users"===b&&(0,E.jsxs)("div",{className:"space-y-4",children:[(0,E.jsxs)("div",{className:"flex items-center justify-between",children:[(0,E.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:r("chat.admin.activeUsers","\ud65c\uc131 \uc0ac\uc6a9\uc790")}),(0,E.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[(0,E.jsx)(n.A,{className:"w-4 h-4"}),(0,E.jsxs)("span",{children:[u?"1":"0"," ",r("chat.admin.online","\uc628\ub77c\uc778")]})]})]}),u?(0,E.jsx)("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg",children:(0,E.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,E.jsx)("div",{className:"w-10 h-10 bg-blue-500 rounded-full flex items-center justify-center text-white font-semibold",children:"U"}),(0,E.jsxs)("div",{children:[(0,E.jsx)("div",{className:"font-medium text-gray-900 dark:text-white",children:r("chat.admin.anonymousUser","\uc775\uba85 \uc0ac\uc6a9\uc790")}),(0,E.jsxs)("div",{className:"text-sm text-gray-500",children:[r("chat.admin.connectionId","\uc5f0\uacb0 ID"),": ",u.slice(0,8),"..."]})]}),(0,E.jsx)("div",{className:"ml-auto",children:(0,E.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"})})]})}):(0,E.jsx)("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:r("chat.admin.noActiveUsers","\ud604\uc7ac \ud65c\uc131 \uc0ac\uc6a9\uc790\uac00 \uc5c6\uc2b5\ub2c8\ub2e4.")})]})]})]})}):null},W=e=>{let{className:t}=e;const{t:s}=(0,S.Bd)(),{theme:g}=(0,m.m)(),{isOpen:u,isMinimized:b,unreadCount:y,isConnected:p,agentAvailable:j,businessHours:f,openChat:v,closeChat:N,toggleMinimize:w,markAllAsRead:k}=(0,h.v)(),[A,C]=(0,a.useState)(!1),[R,M]=(0,a.useState)(!1),[L,P]=(0,a.useState)(!1),O=(0,a.useRef)(null);(0,a.useEffect)(()=>{const e=setTimeout(()=>{C(!0)},2e3);return()=>clearTimeout(e)},[]),(0,a.useEffect)(()=>{const e=e=>{e.ctrlKey&&e.shiftKey&&"A"===e.key&&(e.preventDefault(),P(!0)),"Escape"===e.key&&L&&P(!1)};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[L]),(0,a.useEffect)(()=>{const e=e=>{O.current&&!O.current.contains(e.target)&&u&&!b&&w()};if(u)return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[u,b,w]);const F=()=>p?j&&f.isOpen?"#10b981":"#f59e0b":"dark"===g?"#ef4444":"#dc2626";return A?(0,E.jsxs)("div",{ref:O,className:"fixed bottom-4 right-4 z-50 font-sans ".concat(t),style:{fontFamily:"Pretendard, -apple-system, BlinkMacSystemFont, sans-serif"},children:[(0,E.jsx)(r.N,{children:u&&(0,E.jsx)(l.P.div,{initial:{opacity:0,scale:.8,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.8,y:20},transition:{duration:.3,ease:[.25,.1,.25,1]},className:"mb-4 ".concat(b?"pointer-events-none":""),children:(0,E.jsxs)("div",{className:"\n              bg-white dark:bg-gray-800 \n              border border-gray-200 dark:border-gray-700 \n              rounded-lg shadow-2xl \n              w-80 h-96 \n              flex flex-col\n              ".concat(b?"opacity-0 scale-95":"opacity-100 scale-100","\n              transition-all duration-300\n            "),children:[(0,E.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700 bg-gradient-to-r from-blue-500 to-blue-600 rounded-t-lg",children:[(0,E.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,E.jsxs)("div",{className:"relative",children:[(0,E.jsx)("div",{className:"w-10 h-10 bg-white rounded-full flex items-center justify-center",children:(0,E.jsx)(n.A,{className:"w-6 h-6 text-blue-600"})}),(0,E.jsx)("div",{className:"absolute -bottom-1 -right-1 w-4 h-4 border-2 border-white rounded-full",style:{backgroundColor:F()}})]}),(0,E.jsxs)("div",{className:"text-white",children:[(0,E.jsx)("h3",{className:"font-semibold text-sm",children:s("chat.title","\uace0\uac1d \uc9c0\uc6d0")}),(0,E.jsx)("p",{className:"text-xs opacity-90",children:p?j&&f.isOpen?s("chat.status.online"):f.isOpen?s("chat.status.busy"):s("chat.status.afterHours"):s("chat.status.offline")})]})]}),(0,E.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,E.jsx)("button",{onClick:w,className:"p-1 rounded-full hover:bg-white/20 transition-colors","aria-label":s(b?"chat.maximize":"chat.minimize"),children:b?(0,E.jsx)(c.A,{className:"w-4 h-4 text-white"}):(0,E.jsx)(i.A,{className:"w-4 h-4 text-white"})}),(0,E.jsx)("button",{onClick:N,className:"p-1 rounded-full hover:bg-white/20 transition-colors","aria-label":s("chat.close"),children:(0,E.jsx)(d.A,{className:"w-4 h-4 text-white"})})]})]}),!b&&(0,E.jsx)(D,{})]})})}),(0,E.jsxs)(l.P.button,{onClick:()=>{u?b?(w(),k()):w():(v(),k())},onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),u?b&&(w(),k()):(v(),k()))},onMouseEnter:()=>M(!0),onMouseLeave:()=>M(!1),whileHover:{scale:1.05},whileTap:{scale:.95},className:"\n          relative w-14 h-14 rounded-full shadow-lg\n          bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700\n          text-white flex items-center justify-center\n          transition-all duration-300 ease-out\n          focus:outline-none focus:ring-4 focus:ring-blue-500/30\n          ".concat(u?"rotate-0":"rotate-0 hover:rotate-3","\n        "),"aria-label":s(u?"chat.close":"chat.open"),role:"button",tabIndex:0,children:[(0,E.jsx)("div",{className:"absolute -top-1 -right-1 w-4 h-4 border-2 border-white rounded-full animate-pulse",style:{backgroundColor:F()}}),y>0&&(0,E.jsx)(l.P.div,{initial:{scale:0},animate:{scale:1},className:"absolute -top-2 -left-2 bg-red-500 text-white text-xs font-bold rounded-full w-6 h-6 flex items-center justify-center",children:y>99?"99+":y}),(0,E.jsx)(l.P.div,{animate:{rotate:u?45:0},transition:{duration:.3},children:u?(0,E.jsx)(d.A,{className:"w-6 h-6"}):(0,E.jsx)(o.A,{className:"w-6 h-6"})}),R&&!u&&(0,E.jsx)(l.P.div,{className:"absolute inset-0 rounded-full bg-white/20",initial:{scale:.8,opacity:0},animate:{scale:1.2,opacity:0},transition:{duration:1,repeat:1/0}})]}),(0,E.jsx)(r.N,{children:R&&!u&&(0,E.jsxs)(l.P.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},className:"absolute right-full mr-3 top-1/2 transform -translate-y-1/2 bg-gray-900 dark:bg-gray-100 text-white dark:text-gray-900 px-3 py-2 rounded-lg text-sm whitespace-nowrap shadow-lg",children:[(0,E.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,E.jsx)(o.A,{className:"w-4 h-4"}),(0,E.jsx)("span",{children:j&&f.isOpen?s("chat.quickInfo.available","\uc9c0\uae08 \ucc44\ud305\ud558\uc138\uc694!"):s("chat.quickInfo.unavailable","\uba54\uc2dc\uc9c0\ub97c \ub0a8\uaca8\uc8fc\uc138\uc694")})]}),!f.isOpen&&(0,E.jsxs)("div",{className:"flex items-center space-x-2 mt-1 text-xs opacity-80",children:[(0,E.jsx)(x.A,{className:"w-3 h-3"}),(0,E.jsx)("span",{children:s("chat.businessHours","\uc6b4\uc601\uc2dc\uac04: ".concat(f.hours))})]}),(0,E.jsx)("div",{className:"absolute left-full top-1/2 transform -translate-y-1/2 w-0 h-0 border-l-4 border-l-gray-900 dark:border-l-gray-100 border-y-4 border-y-transparent"})]})}),(0,E.jsx)(r.N,{children:L&&(0,E.jsx)(_,{isOpen:L,onClose:()=>P(!1)})})]}):null}}}]);
//# sourceMappingURL=479.ef30cc7c.chunk.js.map