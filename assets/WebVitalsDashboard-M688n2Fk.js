import{j as i}from"./ui-vendor-i7F9FKVx.js";import{r as g}from"./react-vendor-BOp29kWJ.js";import"./index-DWd285fD.js";import"./i18n-C26XKfAY.js";let H=-1;const f=t=>{addEventListener("pageshow",(e=>{e.persisted&&(H=e.timeStamp,t(e))}),!0)},u=(t,e,s,r)=>{let n,l;return a=>{e.value>=0&&(a||r)&&(l=e.value-(n??0),(l||n===void 0)&&(n=e.value,e.delta=l,e.rating=((o,c)=>o>c[1]?"poor":o>c[0]?"needs-improvement":"good")(e.value,s),t(e)))}},L=t=>{requestAnimationFrame((()=>requestAnimationFrame((()=>t()))))},S=()=>{const t=performance.getEntriesByType("navigation")[0];if(t&&t.responseStart>0&&t.responseStart<performance.now())return t},v=()=>S()?.activationStart??0,m=(t,e=-1)=>{const s=S();let r="navigate";return H>=0?r="back-forward-cache":s&&(document.prerendering||v()>0?r="prerender":document.wasDiscarded?r="restore":s.type&&(r=s.type.replace(/_/g,"-"))),{name:t,value:e,rating:"good",delta:0,entries:[],id:`v5-${Date.now()}-${Math.floor(8999999999999*Math.random())+1e12}`,navigationType:r}},C=new WeakMap;function M(t,e){return C.get(t)||C.set(t,new e),C.get(t)}class z{t;i=0;o=[];h(e){if(e.hadRecentInput)return;const s=this.o[0],r=this.o.at(-1);this.i&&s&&r&&e.startTime-r.startTime<1e3&&e.startTime-s.startTime<5e3?(this.i+=e.value,this.o.push(e)):(this.i=e.value,this.o=[e]),this.t?.(e)}}const x=(t,e,s={})=>{try{if(PerformanceObserver.supportedEntryTypes.includes(t)){const r=new PerformanceObserver((n=>{Promise.resolve().then((()=>{e(n.getEntries())}))}));return r.observe({type:t,buffered:!0,...s}),r}}catch{}},E=t=>{let e=!1;return()=>{e||(t(),e=!0)}};let p=-1;const R=new Set,I=()=>document.visibilityState!=="hidden"||document.prerendering?1/0:0,P=t=>{if(document.visibilityState==="hidden"){if(t.type==="visibilitychange")for(const e of R)e();isFinite(p)||(p=t.type==="visibilitychange"?t.timeStamp:0,removeEventListener("prerenderingchange",P,!0))}},y=()=>{if(p<0){const t=v();p=(document.prerendering?void 0:globalThis.performance.getEntriesByType("visibility-state").filter((s=>s.name==="hidden"&&s.startTime>t))[0]?.startTime)??I(),addEventListener("visibilitychange",P,!0),addEventListener("prerenderingchange",P,!0),f((()=>{setTimeout((()=>{p=I()}))}))}return{get firstHiddenTime(){return p},onHidden(t){R.add(t)}}},T=t=>{document.prerendering?addEventListener("prerenderingchange",(()=>t()),!0):t()},F=[1800,3e3],_=(t,e={})=>{T((()=>{const s=y();let r,n=m("FCP");const l=x("paint",(a=>{for(const o of a)o.name==="first-contentful-paint"&&(l.disconnect(),o.startTime<s.firstHiddenTime&&(n.value=Math.max(o.startTime-v(),0),n.entries.push(o),r(!0)))}));l&&(r=u(t,n,F,e.reportAllChanges),f((a=>{n=m("FCP"),r=u(t,n,F,e.reportAllChanges),L((()=>{n.value=performance.now()-a.timeStamp,r(!0)}))})))}))},k=[.1,.25],G=(t,e={})=>{const s=y();_(E((()=>{let r,n=m("CLS",0);const l=M(e,z),a=c=>{for(const d of c)l.h(d);l.i>n.value&&(n.value=l.i,n.entries=l.o,r())},o=x("layout-shift",a);o&&(r=u(t,n,k,e.reportAllChanges),s.onHidden((()=>{a(o.takeRecords()),r(!0)})),f((()=>{l.i=0,n=m("CLS",0),r=u(t,n,k,e.reportAllChanges),L((()=>r()))})),setTimeout(r))})))};let $=0,j=1/0,b=0;const J=t=>{for(const e of t)e.interactionId&&(j=Math.min(j,e.interactionId),b=Math.max(b,e.interactionId),$=b?(b-j)/7+1:0)};let w;const A=()=>w?$:performance.interactionCount??0,K=()=>{"interactionCount"in performance||w||(w=x("event",J,{type:"event",buffered:!0,durationThreshold:0}))};let B=0;class Q{u=[];l=new Map;m;p;v(){B=A(),this.u.length=0,this.l.clear()}L(){const e=Math.min(this.u.length-1,Math.floor((A()-B)/50));return this.u[e]}h(e){if(this.m?.(e),!e.interactionId&&e.entryType!=="first-input")return;const s=this.u.at(-1);let r=this.l.get(e.interactionId);if(r||this.u.length<10||e.duration>s.P){if(r?e.duration>r.P?(r.entries=[e],r.P=e.duration):e.duration===r.P&&e.startTime===r.entries[0].startTime&&r.entries.push(e):(r={id:e.interactionId,entries:[e],P:e.duration},this.l.set(r.id,r),this.u.push(r)),this.u.sort(((n,l)=>l.P-n.P)),this.u.length>10){const n=this.u.splice(10);for(const l of n)this.l.delete(l.id)}this.p?.(r)}}}const q=t=>{const e=globalThis.requestIdleCallback||setTimeout;document.visibilityState==="hidden"?t():(t=E(t),addEventListener("visibilitychange",t,{once:!0,capture:!0}),e((()=>{t(),removeEventListener("visibilitychange",t,{capture:!0})})))},D=[200,500],U=(t,e={})=>{if(!globalThis.PerformanceEventTiming||!("interactionId"in PerformanceEventTiming.prototype))return;const s=y();T((()=>{K();let r,n=m("INP");const l=M(e,Q),a=c=>{q((()=>{for(const h of c)l.h(h);const d=l.L();d&&d.P!==n.value&&(n.value=d.P,n.entries=d.entries,r())}))},o=x("event",a,{durationThreshold:e.durationThreshold??40});r=u(t,n,D,e.reportAllChanges),o&&(o.observe({type:"first-input",buffered:!0}),s.onHidden((()=>{a(o.takeRecords()),r(!0)})),f((()=>{l.v(),n=m("INP"),r=u(t,n,D,e.reportAllChanges)})))}))};class X{m;h(e){this.m?.(e)}}const O=[2500,4e3],Y=(t,e={})=>{T((()=>{const s=y();let r,n=m("LCP");const l=M(e,X),a=c=>{e.reportAllChanges||(c=c.slice(-1));for(const d of c)l.h(d),d.startTime<s.firstHiddenTime&&(n.value=Math.max(d.startTime-v(),0),n.entries=[d],r())},o=x("largest-contentful-paint",a);if(o){r=u(t,n,O,e.reportAllChanges);const c=E((()=>{a(o.takeRecords()),o.disconnect(),r(!0)})),d=h=>{h.isTrusted&&(q(c),removeEventListener(h.type,d,{capture:!0}))};for(const h of["keydown","click","visibilitychange"])addEventListener(h,d,{capture:!0});f((h=>{n=m("LCP"),r=u(t,n,O,e.reportAllChanges),L((()=>{n.value=performance.now()-h.timeStamp,r(!0)}))}))}}))},V=[800,1800],N=t=>{document.prerendering?T((()=>N(t))):document.readyState!=="complete"?addEventListener("load",(()=>N(t)),!0):setTimeout(t)},Z=(t,e={})=>{let s=m("TTFB"),r=u(t,s,V,e.reportAllChanges);N((()=>{const n=S();n&&(s.value=Math.max(n.responseStart-v(),0),s.entries=[n],r(!0),f((()=>{s=m("TTFB",0),r=u(t,s,V,e.reportAllChanges),r(!0)})))}))},ee=(t,e)=>{const r={CLS:{good:.1,poor:.25},FCP:{good:1800,poor:3e3},LCP:{good:2500,poor:4e3},TTFB:{good:800,poor:1800},INP:{good:200,poor:500}}[t];return r?e<=r.good?"good":e>=r.poor?"poor":"needs-improvement":"needs-improvement"},te=(t,e)=>t==="CLS"?e.toFixed(3):`${Math.round(e)}ms`,re=t=>({CLS:"Cumulative Layout Shift - Visual stability",FCP:"First Contentful Paint - First render time",LCP:"Largest Contentful Paint - Loading performance",TTFB:"Time to First Byte - Server response time",INP:"Interaction to Next Paint - Overall responsiveness"})[t]||"",W=g.memo(({metric:t})=>{const e={good:"bg-green-100 text-green-800 border-green-300","needs-improvement":"bg-yellow-100 text-yellow-800 border-yellow-300",poor:"bg-red-100 text-red-800 border-red-300"},s={good:"‚úÖ","needs-improvement":"‚ö†Ô∏è",poor:"‚ùå"};return i.jsxs("div",{className:`p-4 rounded-lg border-2 transition-all hover:shadow-lg ${e[t.rating]}`,children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h3",{className:"text-lg font-semibold",children:t.name}),i.jsx("span",{className:"text-2xl",children:s[t.rating]})]}),i.jsx("div",{className:"text-2xl font-bold mb-2",children:te(t.name,t.value)}),i.jsx("p",{className:"text-sm opacity-75",children:re(t.name)}),i.jsxs("div",{className:"mt-2 text-xs opacity-50",children:["Measured at: ",new Date(t.timestamp).toLocaleTimeString()]})]})});W.displayName="MetricCard";const ne=g.memo(()=>{const[t,e]=g.useState({CLS:null,FCP:null,LCP:null,TTFB:null,INP:null}),[s,r]=g.useState(!1),n=g.useRef(!1);if(g.useEffect(()=>{if(n.current)return;n.current=!0;const a=o=>{const c={name:o.name,value:o.value,rating:ee(o.name,o.value),timestamp:Date.now()};e(d=>({...d,[o.name]:c})),window.gtag&&window.gtag("event","web_vital",{metric_name:o.name,metric_value:o.value,metric_rating:c.rating})};G(a),_(a),Y(a),Z(a),U(a)},[]),!s)return null;const l=Object.values(t).some(a=>a!==null);return i.jsxs(i.Fragment,{children:[!1,s&&i.jsxs("div",{"data-testid":"web-vitals-dashboard",className:"fixed bottom-20 right-4 z-40 bg-white dark:bg-gray-800 p-6 rounded-lg shadow-2xl max-w-4xl max-h-[80vh] overflow-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h2",{className:"text-2xl font-bold text-gray-800 dark:text-white",children:"Web Vitals Dashboard"}),i.jsx("button",{onClick:()=>r(!1),className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200","aria-label":"Close dashboard",children:"‚úï"})]}),l?i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:Object.entries(t).map(([a,o])=>o&&i.jsx(W,{metric:o},a))}):i.jsxs("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:[i.jsx("p",{className:"mb-2",children:"Collecting metrics..."}),i.jsx("p",{className:"text-sm",children:"Navigate around the site to generate metrics"}),i.jsx("p",{className:"text-xs mt-4 opacity-50",children:"Press Ctrl+Shift+V to toggle this dashboard"})]}),l&&i.jsxs("div",{className:"mt-6 p-4 bg-gray-100 dark:bg-gray-700 rounded-lg",children:[i.jsx("h3",{className:"font-semibold mb-2",children:"Performance Summary"}),i.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("span",{className:"text-green-600",children:"Good: "}),Object.values(t).filter(a=>a?.rating==="good").length]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-yellow-600",children:"Needs Improvement: "}),Object.values(t).filter(a=>a?.rating==="needs-improvement").length]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-red-600",children:"Poor: "}),Object.values(t).filter(a=>a?.rating==="poor").length]})]})]}),i.jsxs("div",{className:"mt-4 text-xs text-gray-500 dark:text-gray-400",children:[i.jsx("p",{children:"üí° Tip: Metrics are collected as you interact with the page."}),i.jsx("p",{children:"üìà Data is sent to analytics if configured."}),i.jsx("p",{children:"‚å®Ô∏è Press Ctrl+Shift+V to toggle this dashboard."})]})]})]})});ne.displayName="WebVitalsDashboard";export{ne as default};
//# sourceMappingURL=WebVitalsDashboard-M688n2Fk.js.map
