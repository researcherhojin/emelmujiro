import{j as e,W as s,J as n,h as t,R as i}from"./ui-vendor-CIRe6Htr.js";import{r as a}from"./react-vendor-CcwLiv3B.js";const r=a.memo(()=>{const[r,o]=a.useState({isOnline:navigator.onLine,syncStatus:"idle",pendingRequests:0}),[l,c]=a.useState(!navigator.onLine);a.useEffect(()=>{const e=()=>{o(e=>({...e,isOnline:!0,syncStatus:"syncing"})),c(!0),setTimeout(()=>{o(e=>({...e,syncStatus:"success",pendingRequests:0})),setTimeout(()=>{o(e=>({...e,syncStatus:"idle"})),c(!1)},2e3)},1500)},s=()=>{o(e=>({...e,isOnline:!1,syncStatus:"idle",pendingRequests:e.pendingRequests+1})),c(!0)},n=n=>{const{type:t,data:i}=n.data||{};switch(t){case"NETWORK_STATUS":i?.online?e():s();break;case"SYNC_STATUS":o(e=>({...e,syncStatus:i?.status||"idle",pendingRequests:i?.pendingCount||0}));break;case"BACKGROUND_SYNC_COMPLETE":o(e=>({...e,syncStatus:"success",pendingRequests:Math.max(0,e.pendingRequests-1)})),setTimeout(()=>{o(e=>({...e,syncStatus:"idle"}))},2e3)}};return window.addEventListener("online",e),window.addEventListener("offline",s),"serviceWorker"in navigator&&navigator.serviceWorker.addEventListener&&navigator.serviceWorker.addEventListener("message",n),navigator.onLine||(o(e=>({...e,isOnline:!1})),c(!0)),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",s),"serviceWorker"in navigator&&navigator.serviceWorker.removeEventListener&&navigator.serviceWorker.removeEventListener("message",n)}},[]);if(!l)return null;const d=(()=>{const{isOnline:a,syncStatus:o,pendingRequests:l}=r;if(!a)return{icon:e.jsx(s,{className:"w-4 h-4"}),title:"오프라인 상태",message:l>0?`${l}개 요청이 대기 중입니다`:"일부 기능이 제한될 수 있습니다",bgColor:"bg-red-500",showActions:!0};switch(o){case"syncing":return{icon:e.jsx(i,{className:"w-4 h-4 animate-spin"}),title:"동기화 중",message:"데이터를 업데이트하고 있습니다...",bgColor:"bg-blue-500",showActions:!1};case"success":return{icon:e.jsx(t,{className:"w-4 h-4"}),title:"온라인 연결됨",message:"모든 기능을 사용할 수 있습니다",bgColor:"bg-green-500",showActions:!1};case"error":return{icon:e.jsx(n,{className:"w-4 h-4"}),title:"동기화 오류",message:"일부 데이터 동기화에 실패했습니다",bgColor:"bg-orange-500",showActions:!0};default:return null}})();return d?e.jsxs("div",{className:`fixed top-4 right-4 z-50 ${d.bgColor} text-white rounded-lg shadow-lg\n                  p-4 max-w-sm transition-all duration-300 animate-fade-in`,role:"alert","aria-live":"polite","aria-atomic":"true",children:[e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"flex-shrink-0 mt-0.5",children:d.icon}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-sm font-semibold",children:d.title}),e.jsx("div",{className:"text-xs opacity-90 mt-1",children:d.message}),"syncing"===r.syncStatus&&e.jsx("div",{className:"mt-2 h-1 bg-white/20 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-white rounded-full transition-all duration-1000 animate-pulse",style:{width:"75%"}})})]}),e.jsx("button",{onClick:()=>{c(!1)},className:"flex-shrink-0 text-white/70 hover:text-white transition-colors","aria-label":"알림 닫기",children:e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]}),d.showActions&&e.jsxs("div",{className:"mt-3 pt-3 border-t border-white/20 flex space-x-2",children:[e.jsx("button",{onClick:()=>{window.location.reload()},className:"flex-1 bg-white/10 hover:bg-white/20 text-xs py-2 px-3 rounded\n                       transition-colors duration-200 font-medium","aria-label":"연결 상태 다시 확인",children:"다시 시도"}),!r.isOnline&&e.jsx("button",{onClick:()=>c(!1),className:"bg-white/10 hover:bg-white/20 text-xs py-2 px-3 rounded\n                         transition-colors duration-200","aria-label":"알림 숨기기",children:"숨기기"})]})]}):null});r.displayName="OfflineIndicator";export{r as default};
