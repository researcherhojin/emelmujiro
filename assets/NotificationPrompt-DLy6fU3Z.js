import{j as e,X as b,K as k,N as v}from"./ui-vendor-B8I1SmuU.js";import{r as l}from"./react-vendor-BPZHHc88.js";import{l as y}from"./index-D7wojeWw.js";import"./i18n-C_xjgTvF.js";var S={};const P=S.REACT_APP_VAPID_PUBLIC_KEY||"YOUR_PUBLIC_VAPID_KEY";function C(s){const r="=".repeat((4-s.length%4)%4),h=(s+r).replace(/-/g,"+").replace(/_/g,"/"),i=window.atob(h),d=new ArrayBuffer(i.length),c=new Uint8Array(d);for(let o=0;o<i.length;++o)c[o]=i.charCodeAt(o);return c}function u(){return"serviceWorker"in navigator&&"PushManager"in window}async function I(){return u()?await Notification.requestPermission()==="granted":(y.info("Push notifications are not supported in this browser"),!1)}async function _(){if(!u())throw new Error("Push notifications are not supported");if(Notification.permission!=="granted")throw new Error("Notification permission not granted");try{const s=await navigator.serviceWorker.ready;let r=await s.pushManager.getSubscription();return r||(r=await s.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:C(P)})),r}catch(s){throw y.error("Failed to subscribe to push notifications:",s),s}}const B=({onClose:s,className:r=""})=>{const[h,i]=l.useState(!1),[d,c]=l.useState(!1),[o,x]=l.useState(!1),[n,f]=l.useState({blog:!0,contact:!0,system:!0,marketing:!1});l.useEffect(()=>{if(u()){const a=localStorage.getItem("notification-prompt-dismissed"),m=a?parseInt(a):0,w=(Date.now()-m)/(1e3*60*60*24);Notification.permission==="default"&&w>3&&i(!0)}const t=localStorage.getItem("notification-settings");if(t)try{f(JSON.parse(t))}catch(a){console.error("Failed to load notification settings:",a)}},[]);const p=async()=>{c(!0);try{await I()&&(await _(),localStorage.setItem("notification-settings",JSON.stringify(n)),i(!1),s&&s())}catch(t){console.error("Failed to enable notifications:",t)}finally{c(!1)}},j=()=>{localStorage.setItem("notification-prompt-dismissed",Date.now().toString()),i(!1),s&&s()},g=(t,a)=>{const m={...n,[t]:a};f(m),localStorage.setItem("notification-settings",JSON.stringify(m))},N=async t=>{try{if(!(await fetch("/api/notifications/preferences/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).ok)throw new Error("Failed to save notification settings")}catch(a){console.error("Failed to save notification settings:",a)}};return!u()||!h?null:o?e.jsx("div",{className:`fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 p-4 ${r}`,children:e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"알림 설정"}),e.jsx("button",{onClick:()=>x(!1),className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200","aria-label":"설정 닫기",children:e.jsx(b,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"블로그 업데이트"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"새 글이 게시될 때 알림"})]}),e.jsx("input",{type:"checkbox",checked:n.blog,onChange:t=>g("blog",t.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"문의 응답"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"문의에 대한 응답 알림"})]}),e.jsx("input",{type:"checkbox",checked:n.contact,onChange:t=>g("contact",t.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"시스템 알림"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"중요한 시스템 업데이트"})]}),e.jsx("input",{type:"checkbox",checked:n.system,onChange:t=>g("system",t.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"마케팅 정보"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"프로모션 및 이벤트 정보"})]}),e.jsx("input",{type:"checkbox",checked:n.marketing,onChange:t=>g("marketing",t.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"})]})]}),e.jsxs("div",{className:"mt-6 flex space-x-3",children:[e.jsx("button",{onClick:()=>{N(n),x(!1)},className:`flex-1 bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-lg
                           font-medium transition-colors duration-200`,children:"저장"}),e.jsx("button",{onClick:()=>x(!1),className:`flex-1 bg-gray-200 hover:bg-gray-300 dark:bg-gray-700
                           dark:hover:bg-gray-600 text-gray-700 dark:text-gray-200
                           py-2 px-4 rounded-lg font-medium transition-colors duration-200`,children:"취소"})]})]})})}):e.jsx("div",{className:`fixed bottom-4 right-4 z-50 bg-white dark:bg-gray-800 rounded-lg shadow-xl
                     p-6 max-w-sm border border-gray-200 dark:border-gray-700 ${r}`,children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-10 h-10 bg-blue-100 dark:bg-blue-900 rounded-lg flex items-center justify-center",children:e.jsx(k,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-1",children:"알림 허용하기"}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-300 mb-4",children:"새 블로그 글과 중요한 업데이트를 놓치지 마세요. 언제든지 설정에서 변경할 수 있습니다."}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:p,disabled:d,className:`flex-1 bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400
                         text-white py-2 px-3 rounded text-xs font-medium
                         transition-colors duration-200 disabled:cursor-not-allowed`,children:d?"설정 중...":"허용"}),e.jsx("button",{onClick:()=>x(!0),className:`p-2 text-gray-500 hover:text-gray-700 dark:text-gray-400
                         dark:hover:text-gray-200 transition-colors duration-200`,"aria-label":"알림 설정",children:e.jsx(v,{className:"w-4 h-4"})}),e.jsx("button",{onClick:j,className:`p-2 text-gray-500 hover:text-gray-700 dark:text-gray-400
                         dark:hover:text-gray-200 transition-colors duration-200`,"aria-label":"나중에",children:e.jsx(b,{className:"w-4 h-4"})})]})]})]})})};export{B as default};
//# sourceMappingURL=NotificationPrompt-DLy6fU3Z.js.map
